{"version":3,"sources":["game.js"],"names":["playerClass","require","blockClass","stageClass","cc","Class","extends","Component","properties","player","blockJs","stageManager","scoreLabel","Label","onLoad","setTouchStart","numScoreTotal","manager","director","getCollisionManager","enabled","update","node","on","Node","EventType","TOUCH_START","gameTouchStart","TOUCH_END","gameTouchEnd","disableTouch","targetOff","readyJump","e","onJump","jumpFinish","bind","pos","getWorldPlayerPos","currBlock","nextBlock","jumpCheck","success","failure","score","string","moveStage","console","log","setTimeout","resetGame","loadScene"],"mappings":";;;;;;AAAA,IAAIA,cAAcC,QAAQ,UAAR,CAAlB;AACA,IAAIC,aAAaD,QAAQ,SAAR,CAAjB;AACA,IAAIE,aAAaF,QAAQ,gBAAR,CAAjB;;AAEAG,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACRC,gBAAQT,WADA;AAERU,iBAASR,UAFD;AAGRS,sBAAcR,UAHN;AAIRS,oBAAYR,GAAGS;AAJP,KAHP;;AAULC,UAVK,oBAUG;AACJ,aAAKC,aAAL;AACA,aAAKC,aAAL,GAAqB,CAArB;AACA,YAAIC,UAAUb,GAAGc,QAAH,CAAYC,mBAAZ,EAAd;AACAF,gBAAQG,OAAR,GAAkB,IAAlB;AACH,KAfI;AAiBLC,UAjBK,oBAiBG,CAEP,CAnBI;AAqBLN,iBArBK,2BAqBU;AACX,aAAKO,IAAL,CAAUC,EAAV,CAAanB,GAAGoB,IAAH,CAAQC,SAAR,CAAkBC,WAA/B,EAA4C,KAAKC,cAAjD,EAAiE,IAAjE;AACA,aAAKL,IAAL,CAAUC,EAAV,CAAanB,GAAGoB,IAAH,CAAQC,SAAR,CAAkBG,SAA/B,EAA0C,KAAKC,YAA/C,EAA6D,IAA7D;AACH,KAxBI;AA0BLC,gBA1BK,0BA0BS;AACV,aAAKR,IAAL,CAAUS,SAAV,CAAoB,IAApB;AACH,KA5BI;AA8BLJ,kBA9BK,4BA8BW;AACZ,aAAKlB,MAAL,CAAYuB,SAAZ;AACH,KAhCI;AAkCLH,gBAlCK,wBAkCQI,CAlCR,EAkCU;AACX;AACA;AACA,aAAKxB,MAAL,CAAYyB,MAAZ,CAAmB,KAAKC,UAAL,CAAgBC,IAAhB,CAAqB,IAArB,CAAnB;AACH,KAtCI;AAwCLD,cAxCK,wBAwCO;AACR,YAAIE,MAAM,KAAK5B,MAAL,CAAY6B,iBAAZ,EAAV;AACA,aAAK3B,YAAL,CAAkB4B,SAAlB,GAA8B,KAAK5B,YAAL,CAAkB6B,SAAhD;AACA,aAAK7B,YAAL,CAAkB4B,SAAlB,CAA4BE,SAA5B,CAAsCJ,GAAtC,EAA2C,KAAKK,OAAL,CAAaN,IAAb,CAAkB,IAAlB,CAA3C,EAAoE,KAAKO,OAAL,CAAaP,IAAb,CAAkB,IAAlB,CAApE;AACH,KA5CI;AA8CLM,WA9CK,mBA8CGE,KA9CH,EA8CS;AACV,aAAK5B,aAAL,IAAsB4B,KAAtB;AACA,aAAKhC,UAAL,CAAgBiC,MAAhB,GAAyB,UAAU,KAAK7B,aAAxC;AACA,aAAKL,YAAL,CAAkBmC,SAAlB;AACH,KAlDI;AAoDLH,WApDK,qBAoDI;AAAA;;AACL,aAAKb,YAAL;AACAiB,gBAAQC,GAAR,CAAY,SAAZ;;AAEAC,mBAAW,YAAM;AACb,kBAAKC,SAAL;AACH,SAFD,EAEE,IAFF;AAGH,KA3DI;AA6DLA,aA7DK,uBA6DM;AACP9C,WAAGc,QAAH,CAAYiC,SAAZ,CAAsB,MAAtB;AAEH;AAhEI,CAAT","file":"game.js","sourceRoot":"../../../../assets/Script","sourcesContent":["let playerClass = require('./player');\nlet blockClass = require('./block');\nlet stageClass = require('./stageManager');\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        player: playerClass,\n        blockJs: blockClass,\n        stageManager: stageClass,\n        scoreLabel: cc.Label\n    },\n\n    onLoad(){\n        this.setTouchStart();\n        this.numScoreTotal = 0;\n        let manager = cc.director.getCollisionManager();\n        manager.enabled = true;\n    },\n\n    update(){\n\n    },\n\n    setTouchStart(){\n        this.node.on(cc.Node.EventType.TOUCH_START, this.gameTouchStart ,this);\n        this.node.on(cc.Node.EventType.TOUCH_END, this.gameTouchEnd ,this);\n    },\n\n    disableTouch(){\n        this.node.targetOff(this);\n    },\n\n    gameTouchStart(){\n        this.player.readyJump();\n    },\n\n    gameTouchEnd(e){\n        // let touches = e.getTouches();\n        // let touchLoc = touches[0].getLocation();\n        this.player.onJump(this.jumpFinish.bind(this));\n    },\n\n    jumpFinish(){\n        let pos = this.player.getWorldPlayerPos();\n        this.stageManager.currBlock = this.stageManager.nextBlock;\n        this.stageManager.currBlock.jumpCheck(pos, this.success.bind(this), this.failure.bind(this));\n    },\n\n    success(score){\n        this.numScoreTotal += score;\n        this.scoreLabel.string = '当前分数：' + this.numScoreTotal;\n        this.stageManager.moveStage();\n    },\n\n    failure(){\n        this.disableTouch();\n        console.log('failure');\n\n        setTimeout(() => {\n            this.resetGame();\n        },1000);\n    },\n\n    resetGame(){\n        cc.director.loadScene('main');\n\n    }\n});\n"]}