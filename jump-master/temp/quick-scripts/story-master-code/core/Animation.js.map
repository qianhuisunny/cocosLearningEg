{"version":3,"sources":["Animation.js"],"names":["ActionEnum","cc","Enum","None","FadeIn","FadeOut","Shake","Blink","Scale","Move","Level1","Level2","Level3","Level4","Level5","Class","extends","Component","editor","CC_EDITOR","playOnFocus","executeInEditMode","menu","inspector","properties","action","default","displayName","type","notify","delayTime","actionTime","shakeStrength","blinkCount","scaleSize","moveBegan","v2","moveEnd","preview","t","_record","_runAction","_recordData","x","node","y","opacity","active","scaleX","scaleY","rotation","width","height","_recover","stopAllActions","onLoad","onDestroy","e","fadeOut","i","callFunc","_actionOver","bind","n","sequence","runAction","_genAct","push","fadeIn","strength","count","max","o","length","a","Math","floor","c","getPosition","_randomPos","moveTo","blink","scaleTo","setPosition","_randomByMaxValue","random"],"mappings":"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","file":"Animation.js","sourceRoot":"../../../../../../../.CocosCreator/packages/story-master/code/core","sourcesContent":["var ActionEnum=cc.Enum({None:0,FadeIn:1,FadeOut:2,Shake:3,Blink:4,Scale:5,Move:6}),Shake=cc.Enum({Level1:1,Level2:2,Level3:3,Level4:4,Level5:5});cc.Class({extends:cc.Component,editor:CC_EDITOR&&{playOnFocus:!0,executeInEditMode:!0,menu:\"A-StoryMaster/Animation\",inspector:\"packages://story-master/inspector/Animation.js\"},properties:{action:{default:ActionEnum.None,displayName:\"动作\",type:ActionEnum,notify(){}},delayTime:{default:0,displayName:\"延迟时间\"},actionTime:{default:0,displayName:\"动画时长\"},shakeStrength:{default:1,displayName:\"震动强度\",type:Shake},blinkCount:{default:1,displayName:\"闪烁次数\"},scaleSize:{default:1,displayName:\"缩放比例\"},moveBegan:{default:cc.v2(0,0),displayName:\"开始坐标\"},moveEnd:{default:cc.v2(0,0),displayName:\"结束坐标\"},preview:{default:\"0\",notify:CC_EDITOR&&function(t){this._record(),this._runAction()}},_recordData:null},_record:CC_EDITOR&&function(){this._recordData={x:this.node.x,y:this.node.y,opacity:this.node.opacity,active:this.node.active,scaleX:this.node.scaleX,scaleY:this.node.scaleY,rotation:this.node.rotation,width:this.node.width,height:this.node.height}},_recover:CC_EDITOR&&function(){this.node.stopAllActions(),this._recordData&&(this.node.x=this._recordData.x,this.node.y=this._recordData.y,this.node.opacity=this._recordData.opacity,this.node.active=this._recordData.active,this.node.scaleX=this._recordData.scaleX,this.node.scaleY=this._recordData.scaleY,this.node.rotation=this._recordData.rotation,this.node.width=this._recordData.width,this.node.height=this._recordData.height)},onLoad(){CC_EDITOR||this._runAction()},onDestroy(){if(this.action!==ActionEnum.None&&this.action===ActionEnum.FadeOut){let t=cc.delayTime(this.delayTime),e=cc.fadeOut(this.actionTime),i=cc.callFunc(this._actionOver.bind(this)),n=cc.sequence([t,e,i]);this.node.stopAllActions(),this.node.runAction(n)}},_runAction(){if(this.action!==ActionEnum.None&&this.action!==ActionEnum.FadeOut){if(this.actionTime>0){let t=this._genAct(this.action);if(t){let e=[];this.delayTime>0&&e.push(cc.delayTime(this.delayTime)),e.push(t),e.push(cc.callFunc(this._actionOver.bind(this)));let i=cc.sequence(e);this.node.runAction(i)}}}else this._actionOver()},_actionOver(){CC_EDITOR&&this._recover&&this._recover()},_genAct(t){let e=null;if(t===ActionEnum.FadeOut)this.node.opacity=255,e=cc.fadeOut(this.actionTime);else if(t===ActionEnum.FadeIn)this.node.opacity=0,e=cc.fadeIn(this.actionTime);else if(t===ActionEnum.Shake){let t=[],i=[{strength:1,count:3,max:10},{strength:2,count:5,max:12},{strength:3,count:7,max:15},{strength:4,count:9,max:20},{strength:5,count:11,max:25}],n=0,o=0;for(let t=0;t<i.length;t++){let e=i[t];if(e.strength===this.shakeStrength){n=e.count,o=e.max;break}}let a=.05;n=Math.floor(this.actionTime/a);let c=this.node.getPosition();if(n>0&&o>0){for(let e=0;e<n;e++){let e=c.x+this._randomPos(o),i=c.y+this._randomPos(o),n=cc.moveTo(a,cc.v2(e,i));t.push(n)}e=cc.sequence(t)}}else t===ActionEnum.Blink?e=cc.blink(this.actionTime,this.blinkCount):t===ActionEnum.Scale?e=cc.scaleTo(this.actionTime,this.scaleSize):t===ActionEnum.Move&&(this.node.setPosition(this.moveBegan),e=cc.moveTo(this.actionTime,this.moveEnd));return e},_randomByMaxValue:t=>Math.floor(Math.random()*t),_randomPos(t){return this._randomByMaxValue(2)%2==0?this._randomByMaxValue(t):-this._randomByMaxValue(t)}});"]}