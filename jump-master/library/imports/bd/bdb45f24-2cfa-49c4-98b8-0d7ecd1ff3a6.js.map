{"version":3,"sources":["../../../../../../../../.CocosCreator/packages/story-master/code/.CocosCreator/packages/story-master/code/scene/story/StoryPiece.js"],"names":["StoryAudioMgr","require","cc","Class","extends","editor","CC_EDITOR","executeInEditMode","playOnFocus","menu","properties","_menuNode","_storyTalk","pieceItem","default","visible","_getMsgList","StoryMaster","Msg","PieceShowOptions","OnPieceTalkOver","UserTouch","_onMsg","e","t","ObserverMgr","dispatchMsg","OnEnableGlobalTouch","active","OnGoNextPiece","onUserTouch","onLoad","_initMsg","node","children","length","s","r","getComponent","o","start","PieceHasOptions"],"mappings":";;;;;;AAAA,IAAIA,gBAAcC,QAAQ,eAAR,CAAlB,CAA2CC,GAAGC,KAAH,CAAS,EAACC,SAAQH,QAAQ,UAAR,CAAT,EAA6BI,QAAOC,aAAW,EAACC,mBAAkB,CAAC,CAApB,EAAsBC,aAAY,CAAC,CAAnC,EAAqCC,MAAK,0BAA1C,EAA/C,EAAqHC,YAAW,EAACC,WAAU,IAAX,EAAgBC,YAAW,IAA3B,EAAgCC,WAAU,EAACC,SAAQ,IAAT,EAAcC,SAAQ,CAAC,CAAvB,EAA1C,EAAhI,EAAqMC,aAAY;AAAA,WAAI,CAACd,GAAGe,WAAH,CAAeC,GAAf,CAAmBC,gBAApB,EAAqCjB,GAAGe,WAAH,CAAeC,GAAf,CAAmBE,eAAxD,EAAwElB,GAAGe,WAAH,CAAeC,GAAf,CAAmBG,SAA3F,CAAJ;AAAA,GAAjN,EAA2TC,MAA3T,kBAAkUC,CAAlU,EAAoUC,CAApU,EAAsU;AAACD,UAAIrB,GAAGe,WAAH,CAAeC,GAAf,CAAmBC,gBAAvB,IAAyCjB,GAAGuB,WAAH,CAAeC,WAAf,CAA2BxB,GAAGe,WAAH,CAAeC,GAAf,CAAmBS,mBAA9C,EAAkE,CAAC,CAAnE,GAAsE,KAAKhB,SAAL,CAAeiB,MAAf,GAAsB,CAAC,CAAtI,IAAyIL,MAAIrB,GAAGe,WAAH,CAAeC,GAAf,CAAmBE,eAAvB,GAAuClB,GAAGuB,WAAH,CAAeC,WAAf,CAA2BxB,GAAGe,WAAH,CAAeC,GAAf,CAAmBW,aAA9C,EAA4D,KAAKhB,SAAjE,CAAvC,GAAmHU,MAAIrB,GAAGe,WAAH,CAAeC,GAAf,CAAmBG,SAAvB,KAAmC,KAAKT,UAAL,GAAgB,KAAKA,UAAL,CAAgBkB,WAAhB,EAAhB,GAA8C,KAAKnB,SAAL,IAAgBT,GAAGuB,WAAH,CAAeC,WAAf,CAA2BxB,GAAGe,WAAH,CAAeC,GAAf,CAAmBW,aAA9C,EAA4D,KAAKhB,SAAjE,CAAjG,CAA5P;AAA0a,GAAjvB;AAAkvBkB,QAAlvB,oBAA0vB;AAAC,SAAKC,QAAL,GAAgB,IAAIT,IAAE,KAAKU,IAAL,CAAUC,QAAhB,CAAyB,KAAI,IAAIV,IAAE,CAAV,EAAYA,IAAED,EAAEY,MAAhB,EAAuBX,GAAvB,EAA2B;AAAC,UAAIY,IAAEb,EAAEC,CAAF,CAAN;AAAA,UAAWa,IAAED,EAAEE,YAAF,CAAe,gBAAf,CAAb,CAA8C,SAAO,KAAK3B,SAAZ,IAAuB0B,CAAvB,KAA2B,KAAK1B,SAAL,GAAeyB,CAA1C,EAA6C,IAAIG,IAAEH,EAAEE,YAAF,CAAe,WAAf,CAAN,CAAkC,SAAO,KAAK1B,UAAZ,IAAwB2B,CAAxB,KAA4B,KAAK3B,UAAL,GAAgB2B,CAA5C;AAA+C,UAAK3B,UAAL,GAAgB,KAAKD,SAAL,KAAiB,KAAKA,SAAL,CAAeiB,MAAf,GAAsB,CAAC,CAAxC,CAAhB,GAA2D,KAAKjB,SAAL,KAAiBT,GAAGuB,WAAH,CAAeC,WAAf,CAA2BxB,GAAGe,WAAH,CAAeC,GAAf,CAAmBS,mBAA9C,EAAkE,CAAC,CAAnE,GAAsE,KAAKhB,SAAL,CAAeiB,MAAf,GAAsB,CAAC,CAA9G,CAA3D;AAA4K,GAAxpC;AAAypCY,OAAzpC,mBAAgqC;AAAC,SAAK7B,SAAL,IAAgBT,GAAGuB,WAAH,CAAeC,WAAf,CAA2BxB,GAAGe,WAAH,CAAeC,GAAf,CAAmBuB,eAA9C,EAA8D,IAA9D,CAAhB;AAAoF;AAArvC,CAAT","file":"StoryPiece.js","sourceRoot":"../../../../../../../../.CocosCreator/packages/story-master/code/scene/story","sourcesContent":["let StoryAudioMgr=require(\"StoryAudioMgr\");cc.Class({extends:require(\"Observer\"),editor:CC_EDITOR&&{executeInEditMode:!1,playOnFocus:!1,menu:\"A-StoryMaster/StoryPiece\"},properties:{_menuNode:null,_storyTalk:null,pieceItem:{default:null,visible:!1}},_getMsgList:()=>[cc.StoryMaster.Msg.PieceShowOptions,cc.StoryMaster.Msg.OnPieceTalkOver,cc.StoryMaster.Msg.UserTouch],_onMsg(e,t){e===cc.StoryMaster.Msg.PieceShowOptions?(cc.ObserverMgr.dispatchMsg(cc.StoryMaster.Msg.OnEnableGlobalTouch,!1),this._menuNode.active=!0):e===cc.StoryMaster.Msg.OnPieceTalkOver?cc.ObserverMgr.dispatchMsg(cc.StoryMaster.Msg.OnGoNextPiece,this.pieceItem):e===cc.StoryMaster.Msg.UserTouch&&(this._storyTalk?this._storyTalk.onUserTouch():this._menuNode||cc.ObserverMgr.dispatchMsg(cc.StoryMaster.Msg.OnGoNextPiece,this.pieceItem))},onLoad(){this._initMsg();let e=this.node.children;for(let t=0;t<e.length;t++){let s=e[t],r=s.getComponent(\"StoryOptionBox\");null===this._menuNode&&r&&(this._menuNode=s);let o=s.getComponent(\"StoryTalk\");null===this._storyTalk&&o&&(this._storyTalk=o)}this._storyTalk?this._menuNode&&(this._menuNode.active=!1):this._menuNode&&(cc.ObserverMgr.dispatchMsg(cc.StoryMaster.Msg.OnEnableGlobalTouch,!1),this._menuNode.active=!0)},start(){this._menuNode&&cc.ObserverMgr.dispatchMsg(cc.StoryMaster.Msg.PieceHasOptions,null)}});"]}